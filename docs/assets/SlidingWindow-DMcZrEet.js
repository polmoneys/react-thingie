import{r as c,j as e,a as T,G as b,F as h,I as k,T as B,B as S,d as F}from"./index-DfR4J3qm.js";import{u as L}from"./useQuery-BTuCpXCr.js";import{G as A}from"./index-DA2yu6bt.js";function E({items:n,itemHeight:r,maxRenderedItems:s=42,scrollThreshold:o=5}){const l=c.useRef(null),[t,p]=c.useState(0),[w,d]=c.useState(!1),f=c.useRef(t);c.useEffect(()=>{if(t!==f.current){d(!0),f.current=t;const i=setTimeout(()=>d(!1),100);return()=>clearTimeout(i)}},[t]);const u=Math.min(t+s,n.length),C=n.length*r,a=c.useMemo(()=>n.slice(t,u).map((i,x)=>({item:i,index:t+x,top:(t+x)*r})),[n,t,u,r]),g=c.useCallback(i=>{const x=i.currentTarget.scrollTop,j=Math.floor(x/r),I=j-t,y=t+s-j;if(I>=o){const m=Math.min(o,n.length-(t+s));m>0&&p(M=>Math.min(M+m,n.length-s))}else if(y>=s-o){const m=o;t>0&&p(M=>Math.max(M-m,0))}},[r,t,s,o,n.length]),v=c.useCallback((i,x="smooth")=>{if(l.current){const j=i*r;l.current.scrollTo({top:j,behavior:x});const I=Math.max(0,i-Math.floor(s/2));p(Math.min(I,n.length-s))}},[r,s,n.length]);return{visibleItems:a,containerProps:{ref:l,style:{height:"600px",overflow:"auto",position:"relative"},onScroll:g},innerProps:{style:{height:`${C}px`,position:"relative"}},scrollToIndex:v,currentStartIndex:t,currentEndIndex:u,isAddingItems:w}}async function G(){const n=[];let r=1;for(;r<=9;){const o=await(await fetch(`https://swapi.dev/api/people/?page=${r}`)).json();if(n.push(...o.results),!o.next)break;r++}return n}function N(){const[n,r]=c.useState(""),{data:s=[],isLoading:o}=L({queryKey:["starwars","characters"],queryFn:G}),l=c.useMemo(()=>n?s.filter(a=>a.name.toLowerCase().includes(n.toLowerCase())):s,[s,n]),{visibleItems:t,containerProps:p,innerProps:w,scrollToIndex:d,currentStartIndex:f,currentEndIndex:u,isAddingItems:C}=E({items:l,itemHeight:80,maxRenderedItems:20,scrollThreshold:5});return o?e.jsx(T,{children:e.jsxs(b.Col,{children:[e.jsx(h,{size:"lg",children:"Loading the galaxy far, far away..."}),e.jsx("br",{}),e.jsx(k.LoadingBar,{})," "]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{minHeight:"100vh"},children:[e.jsxs(A,{gridTemplateColumns:{xs:"1fr",md:"1fr .75fr"},gap:{xs:"var(--gap-2)"},children:[e.jsx(B,{label:"",id:"test-search",placeholder:"Search characters...",value:n,onChange:a=>r(a),classNames:{input:"theme-inset"}}),e.jsxs("div",{children:[e.jsx(S,{onClick:()=>d(0),children:"Scroll to Top"}),e.jsx(S,{onClick:()=>d(Math.floor(l.length/2)),children:"Scroll to Middle"}),e.jsx(S,{onClick:()=>d(l.length-1),children:"Scroll to Bottom"})]})]}),e.jsx("br",{}),e.jsx("div",{...p,className:F("slidind-window-container",C&&"noise-scroll"),children:e.jsx("div",{...w,children:t.map(({item:a,index:g,top:v})=>e.jsxs(b.Row,{dangerous:{flexWrap:"wrap",placeContent:"center",position:"absolute",top:`${v}px`,left:0,right:0,height:"80px",padding:"var(--px)",backgroundColor:g%2?"#aaa":"#ccc"},children:[e.jsxs(b.Col,{children:[e.jsxs(h,{children:[g+1,". ",a.name]}),e.jsxs(h,{children:["Height: ",a.height,"cm • Mass:"," ",a.mass,"kg • Born: ",a.birth_year]})]}),e.jsx(S,{className:"ml-a",dangerous:{alignSelf:"center"},onClick:()=>alert(`Clicked ${a.name}`),children:"View"})]},g))})}),e.jsx("br",{}),e.jsxs(T,{children:[e.jsxs(h,{children:["Rendering items ",f," - ",u," ","of ",l.length]}),e.jsxs(h,{children:["Total Items: ",l.length]}),e.jsxs(h,{children:["Rendered Items: ",t.length]}),e.jsxs(h,{children:["Window: [",f,", ",u,"]"]}),e.jsxs(h,{children:["Memory: Only rendering"," ",Math.min(42,l.length)," items at a time"]})]})]}),e.jsx("br",{})]})}export{N as default};
