import{r as c,e as R,j as d,c as z,B as G,I as C,G as U,F as w,a as D}from"./index-Cb4h3VUf.js";import{G as M}from"./GridTemplateColumns-D8iXvaYj.js";import{S as E}from"./index-CHcfE3jK.js";import"./index.module-B8tlVfxN.js";const P="_ul_1uxbg_1",q="_li_1uxbg_9",A="_row_1uxbg_10",H="_disabled_1uxbg_24",b={ul:P,li:q,row:A,disabled:H},L=22,k=({type:i})=>i==="folder"?d.jsx(E.Square,{size:20}):d.jsx(E,{sides:5,size:20});function N(i){const{node:e,depth:s=0,setSelectedId:r,toggleExpand:u,expanded:o,selectedId:m}=i,[f,y]=c.useState(!1),{focusProps:h}=R({onFocus:()=>y(!0),onBlur:()=>y(!1)}),x=e.type==="folder",I=!!o[e.id],S=m===e.id,g=`tree-group-${e.id}`,F=`treeitem-${e.id}`;return d.jsxs("li",{className:b.li,"data-depth":s,children:[d.jsxs("div",{id:F,role:"treeitem","aria-level":s,"aria-selected":S??void 0,"aria-expanded":x?I:void 0,"aria-disabled":e.disabled??void 0,className:z(b.row,e.disabled&&b.disabled),style:{paddingLeft:s*L},onClick:()=>{e.disabled||r(e.id)},children:[x?d.jsx(G.Transparent,{isIcon:!0,onClick:t=>{t.stopPropagation(),u(e.id)},disabled:e.disabled,"aria-label":I?`Collapse ${e.title}`:`Expand ${e.title}`,"aria-expanded":I,"aria-controls":g,...h,children:o[e.id]?d.jsx(C.ChevronDown,{circle:!1,size:48}):d.jsx(C.Chevron,{circle:!1,size:48})}):null,d.jsxs(U.Row,{alignItems:"center",dangerous:{backgroundColor:f?"var(--info)":e.disabled?"var(--neutral)":"var(--positive)",padding:"var(--gap-1)",border:"var(--border)",borderRadius:"var(--border-radius)",boxShadow:"var(--box-shadow)"},children:[d.jsx(k,{type:e.type}),d.jsx(w.Bold,{children:e.title})]})]}),x&&o[e.id]&&e.children.length>0&&d.jsx("ul",{className:b.ul,id:g,role:"group",children:e.children.map(t=>d.jsx(N,{node:t,depth:s+1,selectedId:m,setSelectedId:r,toggleExpand:u,expanded:o},t.id))})]})}function T(i,e){const s=i[e];return s?{id:s.id,title:s.title,type:s.type,children:s.childIds.map(r=>T(i,r)),disabled:s.disabled??!1}:{id:e,title:"(missing)",type:"folder",children:[]}}function O(i){const[e,s]=c.useState(i),[r,u]=c.useState(0),[o,m]=c.useState({0:!0}),f=c.useMemo(()=>T(e,0),[e]),y=c.useCallback(t=>m(a=>({...a,[t]:!a[t]})),[]),h=c.useCallback((t,a)=>{if(!t)return null;if(t.id===a)return t;for(const j of t.children){const n=h(j,a);if(n)return n}return null},[]),{filesUnderSelected:x,fileIdsUnderSelected:I,foldersUnderSelected:S,flatFilesByFolder:g,flatFileIdsByFolder:F}=c.useMemo(()=>{const t=h(f,r);if(!t)return{filesUnderSelected:[],fileIdsUnderSelected:[],foldersUnderSelected:[],flatFilesByFolder:{},flatFileIdsByFolder:{}};const a=[],j=[],n={},B=(l,p)=>{if(!l.disabled)if(l.type==="folder"){l.id!==t.id&&j.push(l);for(const v of l.children)B(v,l.id)}else a.push(l),p!=null&&(n[p]=n[p]??[],n[p].push(l))};B(t,t.type==="folder"?t.id:null);const $=a.map(l=>l.id),_={};for(const l of Object.keys(n)){const p=Number(l);_[p]=n[p].map(v=>v.id)}return{filesUnderSelected:a,fileIdsUnderSelected:$,foldersUnderSelected:j,flatFilesByFolder:n,flatFileIdsByFolder:_}},[h,f,r]);return{state:e,dispatch:s,tree:f,selectedId:r,setSelectedId:u,expanded:o,toggleExpand:y,filesUnderSelected:x,fileIdsUnderSelected:I,foldersUnderSelected:S,flatFilesByFolder:g,flatFileIdsByFolder:F}}const K={0:{id:0,title:"Macintosh HD",type:"folder",childIds:[1,2,8],parentId:null},1:{id:1,title:"Applications",type:"folder",childIds:[3,4],parentId:0},2:{id:2,title:"Users",type:"folder",childIds:[5,6],parentId:0},3:{id:3,title:"Visual Studio Code.app",type:"file",childIds:[],parentId:1},4:{id:4,title:"iTerm.app",type:"file",childIds:[],parentId:1},5:{id:5,title:"alice",type:"folder",childIds:[7],parentId:2},6:{id:6,title:"shared",type:"folder",childIds:[],parentId:2,disabled:!0},7:{id:7,title:"todo.txt",type:"file",childIds:[],parentId:5},8:{id:8,title:"Library",type:"folder",childIds:[],parentId:0}};function W(){const{tree:i,state:e,selectedId:s,setSelectedId:r,expanded:u,toggleExpand:o}=O(K);return d.jsxs(d.Fragment,{children:[d.jsx(D,{mood:"negative",fitContent:!0,children:d.jsxs(U.Row,{gap:"var(--gap-2)",children:[d.jsx(k,{type:e[s]?.type??""}),d.jsxs(w.Bold,{children:[" ",e[s]?.title??"(none)"]})]})}),d.jsx("br",{}),d.jsx(M,{breakEqualHeight:!0,gap:{xs:"var(--gap-2)"},gridTemplateColumns:{xs:"1fr",sm:"1fr 1.7fr"},children:d.jsx("ul",{className:b.ul,children:d.jsx(N,{expanded:u,setSelectedId:r,selectedId:s,toggleExpand:o,node:i,depth:0})})})]})}export{W as default,K as initialFileSystem};
