import{r as c,j as e,a as b,G as T,F as h,I as k,T as B,B as S,d as F}from"./index-BaTGmJ_u.js";import{u as L}from"./useQuery-C7RFp12x.js";import{G as A}from"./index-CO5JzjXn.js";function E({items:n,itemHeight:s,maxRenderedItems:r=42,scrollThreshold:o=5}){const l=c.useRef(null),[t,x]=c.useState(0),[w,d]=c.useState(!1),f=c.useRef(t);c.useEffect(()=>{if(t!==f.current){d(!0),f.current=t;const i=setTimeout(()=>d(!1),100);return()=>clearTimeout(i)}},[t]);const u=Math.min(t+r,n.length),C=n.length*s,a=c.useMemo(()=>n.slice(t,u).map((i,p)=>({item:i,index:t+p,top:(t+p)*s})),[n,t,u,s]),g=c.useCallback(i=>{const p=i.currentTarget.scrollTop,j=Math.floor(p/s),I=j-t,y=t+r-j;if(I>=o){const m=Math.min(o,n.length-(t+r));m>0&&x(M=>Math.min(M+m,n.length-r))}else if(y>=r-o){const m=o;t>0&&x(M=>Math.max(M-m,0))}},[s,t,r,o,n.length]),v=c.useCallback((i,p="smooth")=>{if(l.current){const j=i*s;l.current.scrollTo({top:j,behavior:p});const I=Math.max(0,i-Math.floor(r/2));x(Math.min(I,n.length-r))}},[s,r,n.length]);return{visibleItems:a,containerProps:{ref:l,style:{height:"600px",overflow:"auto",position:"relative"},onScroll:g},innerProps:{style:{height:`${C}px`,position:"relative"}},scrollToIndex:v,currentStartIndex:t,currentEndIndex:u,isAddingItems:w}}async function G(){const n=[];let s=1;for(;s<=9;){const o=await(await fetch(`https://swapi.dev/api/people/?page=${s}`)).json();if(n.push(...o.results),!o.next)break;s++}return n}function N(){const[n,s]=c.useState(""),{data:r=[],isLoading:o}=L({queryKey:["starwars","characters"],queryFn:G}),l=c.useMemo(()=>n?r.filter(a=>a.name.toLowerCase().includes(n.toLowerCase())):r,[r,n]),{visibleItems:t,containerProps:x,innerProps:w,scrollToIndex:d,currentStartIndex:f,currentEndIndex:u,isAddingItems:C}=E({items:l,itemHeight:80,maxRenderedItems:20,scrollThreshold:5});return o?e.jsx(b,{children:e.jsxs(T.Col,{children:[e.jsx(h,{size:"lg",children:"Loading the galaxy far, far away..."}),e.jsx("br",{}),e.jsx(k.LoadingBar,{})," "]})}):e.jsx(e.Fragment,{children:e.jsxs("div",{style:{minHeight:"100vh"},children:[e.jsxs(A,{gridTemplateColumns:{xs:"1fr",md:"1fr .75fr"},gap:{xs:"var(--gap-2)"},children:[e.jsx(B,{label:"",id:"test-search",placeholder:"Search characters...",value:n,onChange:a=>s(a),classNames:{input:"theme-inset"}}),e.jsxs("div",{children:[e.jsx(S,{onClick:()=>d(0),children:"Scroll to Top"}),e.jsx(S,{onClick:()=>d(Math.floor(l.length/2)),children:"Scroll to Middle"}),e.jsx(S,{onClick:()=>d(l.length-1),children:"Scroll to Bottom"})]})]}),e.jsx("br",{}),e.jsx("div",{...x,className:F("slidind-window-container",C&&"noise-scroll"),children:e.jsx("div",{...w,children:t.map(({item:a,index:g,top:v})=>e.jsxs(T.Row,{dangerous:{flexWrap:"wrap",placeContent:"center",position:"absolute",top:`${v}px`,left:0,right:0,height:"80px",padding:"var(--px)",backgroundColor:g%2?"#aaa":"#ccc"},children:[e.jsxs(T.Col,{children:[e.jsxs(h,{children:[g+1,". ",a.name]}),e.jsxs(h,{children:["Height: ",a.height,"cm • Mass:"," ",a.mass,"kg • Born: ",a.birth_year]})]}),e.jsx(S,{className:"ml-a",dangerous:{alignSelf:"center"},onClick:()=>alert(`Clicked ${a.name}`),children:"View"})]},g))})}),e.jsx("br",{}),e.jsxs(b,{children:[e.jsxs(h,{children:["Rendering items ",f," - ",u," ","of ",l.length]}),e.jsxs(h,{children:["Total Items: ",l.length]}),e.jsxs(h,{children:["Rendered Items: ",t.length]}),e.jsxs(h,{children:["Window: [",f,", ",u,"]"]}),e.jsxs(h,{children:["Memory: Only rendering"," ",Math.min(42,l.length)," items at a time"]})]})]})})}export{N as default};
