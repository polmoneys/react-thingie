import{r as x,M as H,j as e,d as $,B as z,I as b,G as F,F as w,a as U,h as k}from"./index-CLMjQahV.js";import{S as _}from"./index-CL5rGkau.js";import{G as R}from"./index-DPQTEJhU.js";import{f as K}from"./intl-DyjOi7tP.js";const L="_ul_1t3az_1",O="_li_1t3az_9",V="_row_1t3az_10",X="_disabled_1t3az_24",v={ul:L,li:O,row:V,disabled:X},J=22,D=({type:r})=>r==="folder"?e.jsx(_.Square,{size:20}):e.jsx(_,{sides:5,size:20});function G(r){const{node:t,depth:d=0,setSelectedId:n,toggleExpand:o,expanded:a,selectedId:m}=r,[c,I]=x.useState(!1),{focusProps:s}=H({onFocus:()=>I(!0),onBlur:()=>I(!1)}),p=t.type==="folder",l=!!a[t.id],f=m===t.id,h=`tree-group-${t.id}`,g=`treeitem-${t.id}`;return e.jsxs("li",{className:v.li,"data-depth":d,children:[e.jsxs("div",{id:g,role:"treeitem","aria-level":d,"aria-selected":f??void 0,"aria-expanded":p?l:void 0,"aria-disabled":t.disabled??void 0,className:$(v.row,t.disabled&&v.disabled),style:{paddingLeft:d*J},children:[p?e.jsx(z.Transparent,{border:!1,isIcon:!0,onClick:i=>{i.stopPropagation(),o(t.id)},disabled:t.disabled,"aria-label":l?`Collapse ${t.title}`:`Expand ${t.title}`,"aria-expanded":l,"aria-controls":h,...s,children:a[t.id]?e.jsx(b.ChevronDown,{circle:!1,size:48}):e.jsx(b.Chevron,{circle:!1,size:48})}):null,e.jsx(F.Row,{alignItems:"center",dangerous:{backgroundColor:c?"var(--info)":t.disabled?"var(--neutral)":"var(--positive)",border:"var(--border)",borderRadius:"var(--border-radius)",boxShadow:"var(--box-shadow)"},children:e.jsxs(z.Transparent,{border:!1,onClick:i=>{i.stopPropagation(),!t.disabled&&n(t.id)},children:[e.jsx(D,{type:t.type}),e.jsx(w.Bold,{children:t.title})]})})]}),p&&a[t.id]&&t.children.length>0&&e.jsx("ul",{className:v.ul,id:h,role:"group",children:t.children.map(i=>e.jsx(G,{node:i,depth:d+1,selectedId:m,setSelectedId:n,toggleExpand:o,expanded:a},i.id))})]})}function M(r,t){const d=r[t];return d?{id:d.id,title:d.title,type:d.type,children:d.childIds.map(n=>M(r,n)),disabled:d.disabled??!1}:{id:t,title:"(missing)",type:"folder",children:[]}}function Q(r){const[t,d]=x.useState(r),[n,o]=x.useState(0),[a,m]=x.useState({0:!0}),c=x.useMemo(()=>M(t,0),[t]),I=x.useCallback(i=>m(y=>({...y,[i]:!y[i]})),[]),s=x.useCallback((i,y)=>{if(!i)return null;if(i.id===y)return i;for(const C of i.children){const j=s(C,y);if(j)return j}return null},[]),{filesUnderSelected:p,fileIdsUnderSelected:l,foldersUnderSelected:f,flatFilesByFolder:h,flatFileIdsByFolder:g}=x.useMemo(()=>{const i=s(c,n);if(!i)return{filesUnderSelected:[],fileIdsUnderSelected:[],foldersUnderSelected:[],flatFilesByFolder:{},flatFileIdsByFolder:{}};const y=[],C=[],j={},E=(u,S)=>{if(!u.disabled)if(u.type==="folder"){u.id!==i.id&&C.push(u);for(const B of u.children)E(B,u.id)}else y.push(u),S!=null&&(j[S]=j[S]??[],j[S].push(u))};E(i,i.type==="folder"?i.id:null);const q=y.map(u=>u.id),T={};for(const u of Object.keys(j)){const S=Number(u);T[S]=j[S].map(B=>B.id)}return{filesUnderSelected:y,fileIdsUnderSelected:q,foldersUnderSelected:C,flatFilesByFolder:j,flatFileIdsByFolder:T}},[s,c,n]);return{state:t,dispatch:d,tree:c,selectedId:n,setSelectedId:o,expanded:a,toggleExpand:I,filesUnderSelected:p,fileIdsUnderSelected:l,foldersUnderSelected:f,flatFilesByFolder:h,flatFileIdsByFolder:g}}function P({items:r,multiple:t=!1,selectedIds:d=new Set,expandedIds:n=new Set,onToggle:o,onSelect:a,renderItem:m,level:c=0,indentSize:I=20}){const s=l=>{const f=n.has(l);o?.(l,!f,c)},p=l=>a?.(l,c);return e.jsx(e.Fragment,{children:r.map(l=>{const f=l.children&&l.children.length>0,h=n.has(l.id),g=d.has(l.id);return e.jsxs(F.Col,{children:[m({className:$(!g&&!h&&"neutral",h&&!g&&"info",g&&"positive"),item:l,level:c,isExpanded:h,isSelected:g,onClick:()=>p(l.id),children:f?e.jsx(z.Transparent,{isIcon:!0,onClick:i=>{i.preventDefault(),s(l.id)},"aria-label":h?"Collapse":"Expand",children:h?e.jsx(b.ChevronDown,{size:28}):e.jsx(b.Chevron,{size:28})}):null}),f&&h&&e.jsx(P,{items:l.children,multiple:t,selectedIds:d,expandedIds:n,onToggle:o,onSelect:a,renderItem:m,level:c+1,indentSize:I})]},l.id)})})}function A(r,t){if(r)for(const d of r){if(d.id===t)return d;if(d.children){const n=A(d.children,t);if(n)return n}}}const N=[{id:"1",data:{name:"src",type:"folder"},children:[{id:"1-1",data:{name:"components",type:"folder"},children:[{id:"1-1-1",data:{name:"Button.tsx",type:"file"}},{id:"1-1-2",data:{name:"Input.tsx",type:"file"}}]},{id:"1-2",data:{name:"utils",type:"folder"},children:[{id:"1-2-1",data:{name:"helpers.ts",type:"file"}}]},{id:"1-3",data:{name:"App.tsx",type:"file"}}]},{id:"2",data:{name:"public",type:"folder"},children:[{id:"2-1",data:{name:"index.html",type:"file"}}]},{id:"3",data:{name:"package.json",type:"file"}}];function W(){const[r,t]=x.useState(new Set),[d,n]=x.useState(new Set),o=[...d].map(s=>A(N,s))??[],a=K(new Set(o.map(s=>s?.data?.name??""))),m=(s,p,l)=>{console.log(`Toggled ${s} at level ${l}:`,p);const f=new Set(r);p?f.add(s):f.delete(s),t(f)},c=(s,p)=>{console.log(`Selected ${s} at level ${p}`);const l=new Set(d);l.has(s)?l.delete(s):l.add(s),n(l)},I=s=>e.jsxs(R,{padding:{xs:`0 var(--gap-3) 0 ${s.level*36}px`},dangerous:{width:"min(450px, 80vw)",alignItems:"center",cursor:"pointer",border:"var(--border)"},gridTemplateColumns:{xs:k(s.children)?"68px 1fr 68px":"68px 1fr"},onClick:s.onClick,className:s.className,children:[s.item.data?.type==="folder"?e.jsx(b.Folder,{circle:!1,size:56}):e.jsx(b.File,{circle:!1,size:56}),e.jsx(w,{children:s.item.data?.name}),k(s.children)?s.children:null]});return e.jsxs(e.Fragment,{children:[e.jsx(U,{mood:"negative",fitContent:!0,children:e.jsxs(F.Row,{gap:"var(--gap-2)",children:[o[0]?.data?.type==="folder"?e.jsx(b.Folder,{circle:!1,size:28}):e.jsx(b.File,{circle:!1,size:28})," ",e.jsxs(w.Bold,{children:[" ",a]})]})}),e.jsx("br",{}),e.jsx(F.Col,{gap:"var(--gap-1)",children:e.jsx(P,{items:N,multiple:!0,selectedIds:d,expandedIds:r,onToggle:m,onSelect:c,renderItem:I,indentSize:24})}),e.jsx("br",{})]})}const Y={0:{id:0,title:"Macintosh HD",type:"folder",childIds:[1,2,8],parentId:null},1:{id:1,title:"Applications",type:"folder",childIds:[3,4],parentId:0},2:{id:2,title:"Users",type:"folder",childIds:[5,6],parentId:0},3:{id:3,title:"Visual Studio Code.app",type:"file",childIds:[],parentId:1},4:{id:4,title:"iTerm.app",type:"file",childIds:[],parentId:1},5:{id:5,title:"alice",type:"folder",childIds:[7],parentId:2},6:{id:6,title:"shared",type:"folder",childIds:[],parentId:2,disabled:!0},7:{id:7,title:"todo.txt",type:"file",childIds:[],parentId:5},8:{id:8,title:"Library",type:"folder",childIds:[],parentId:0}};function se(){const{tree:r,state:t,selectedId:d,setSelectedId:n,expanded:o,toggleExpand:a}=Q(Y);return e.jsxs(e.Fragment,{children:[e.jsx(U,{mood:"negative",fitContent:!0,children:e.jsxs(F.Row,{gap:"var(--gap-2)",children:[e.jsx(D,{type:t[d]?.type??""}),e.jsxs(w.Bold,{children:[" ",t[d]?.title??"(none)"]})]})}),e.jsx("br",{}),e.jsx(R,{breakEqualHeight:!0,gap:{xs:"var(--gap-2)"},gridTemplateColumns:{xs:"1fr",sm:"1fr 1.7fr"},children:e.jsx("ul",{className:v.ul,children:e.jsx(G,{expanded:o,setSelectedId:n,selectedId:d,toggleExpand:a,node:r,depth:0})})}),e.jsx("br",{}),e.jsx(W,{}),e.jsx("br",{})]})}export{se as default,Y as initialFileSystem};
