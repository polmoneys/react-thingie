import{r as c,$ as R,j as d,d as G,B as C,I as E,G as w,F as T,a as P}from"./index-CMDqP-Hg.js";import{S as U}from"./index-CwyL-Q6i.js";import{G as D}from"./index-DB8SWxA1.js";const M="_ul_1t3az_1",q="_li_1t3az_9",A="_row_1t3az_10",H="_disabled_1t3az_24",y={ul:M,li:q,row:A,disabled:H},L=22,k=({type:i})=>i==="folder"?d.jsx(U.Square,{size:20}):d.jsx(U,{sides:5,size:20});function z(i){const{node:e,depth:s=0,setSelectedId:r,toggleExpand:f,expanded:o,selectedId:m}=i,[u,b]=c.useState(!1),{focusProps:h}=R({onFocus:()=>b(!0),onBlur:()=>b(!1)}),x=e.type==="folder",I=!!o[e.id],S=m===e.id,g=`tree-group-${e.id}`,F=`treeitem-${e.id}`;return d.jsxs("li",{className:y.li,"data-depth":s,children:[d.jsxs("div",{id:F,role:"treeitem","aria-level":s,"aria-selected":S??void 0,"aria-expanded":x?I:void 0,"aria-disabled":e.disabled??void 0,className:G(y.row,e.disabled&&y.disabled),style:{paddingLeft:s*L},children:[x?d.jsx(C.Transparent,{border:!1,isIcon:!0,onClick:t=>{t.stopPropagation(),f(e.id)},disabled:e.disabled,"aria-label":I?`Collapse ${e.title}`:`Expand ${e.title}`,"aria-expanded":I,"aria-controls":g,...h,children:o[e.id]?d.jsx(E.ChevronDown,{circle:!1,size:48}):d.jsx(E.Chevron,{circle:!1,size:48})}):null,d.jsx(w.Row,{alignItems:"center",dangerous:{backgroundColor:u?"var(--info)":e.disabled?"var(--neutral)":"var(--positive)",border:"var(--border)",borderRadius:"var(--border-radius)",boxShadow:"var(--box-shadow)"},children:d.jsxs(C.Transparent,{border:!1,onClick:t=>{t.stopPropagation(),!e.disabled&&r(e.id)},children:[d.jsx(k,{type:e.type}),d.jsx(T.Bold,{children:e.title})]})})]}),x&&o[e.id]&&e.children.length>0&&d.jsx("ul",{className:y.ul,id:g,role:"group",children:e.children.map(t=>d.jsx(z,{node:t,depth:s+1,selectedId:m,setSelectedId:r,toggleExpand:f,expanded:o},t.id))})]})}function N(i,e){const s=i[e];return s?{id:s.id,title:s.title,type:s.type,children:s.childIds.map(r=>N(i,r)),disabled:s.disabled??!1}:{id:e,title:"(missing)",type:"folder",children:[]}}function O(i){const[e,s]=c.useState(i),[r,f]=c.useState(0),[o,m]=c.useState({0:!0}),u=c.useMemo(()=>N(e,0),[e]),b=c.useCallback(t=>m(a=>({...a,[t]:!a[t]})),[]),h=c.useCallback((t,a)=>{if(!t)return null;if(t.id===a)return t;for(const j of t.children){const n=h(j,a);if(n)return n}return null},[]),{filesUnderSelected:x,fileIdsUnderSelected:I,foldersUnderSelected:S,flatFilesByFolder:g,flatFileIdsByFolder:F}=c.useMemo(()=>{const t=h(u,r);if(!t)return{filesUnderSelected:[],fileIdsUnderSelected:[],foldersUnderSelected:[],flatFilesByFolder:{},flatFileIdsByFolder:{}};const a=[],j=[],n={},B=(l,p)=>{if(!l.disabled)if(l.type==="folder"){l.id!==t.id&&j.push(l);for(const v of l.children)B(v,l.id)}else a.push(l),p!=null&&(n[p]=n[p]??[],n[p].push(l))};B(t,t.type==="folder"?t.id:null);const $=a.map(l=>l.id),_={};for(const l of Object.keys(n)){const p=Number(l);_[p]=n[p].map(v=>v.id)}return{filesUnderSelected:a,fileIdsUnderSelected:$,foldersUnderSelected:j,flatFilesByFolder:n,flatFileIdsByFolder:_}},[h,u,r]);return{state:e,dispatch:s,tree:u,selectedId:r,setSelectedId:f,expanded:o,toggleExpand:b,filesUnderSelected:x,fileIdsUnderSelected:I,foldersUnderSelected:S,flatFilesByFolder:g,flatFileIdsByFolder:F}}const K={0:{id:0,title:"Macintosh HD",type:"folder",childIds:[1,2,8],parentId:null},1:{id:1,title:"Applications",type:"folder",childIds:[3,4],parentId:0},2:{id:2,title:"Users",type:"folder",childIds:[5,6],parentId:0},3:{id:3,title:"Visual Studio Code.app",type:"file",childIds:[],parentId:1},4:{id:4,title:"iTerm.app",type:"file",childIds:[],parentId:1},5:{id:5,title:"alice",type:"folder",childIds:[7],parentId:2},6:{id:6,title:"shared",type:"folder",childIds:[],parentId:2,disabled:!0},7:{id:7,title:"todo.txt",type:"file",childIds:[],parentId:5},8:{id:8,title:"Library",type:"folder",childIds:[],parentId:0}};function Q(){const{tree:i,state:e,selectedId:s,setSelectedId:r,expanded:f,toggleExpand:o}=O(K);return d.jsxs(d.Fragment,{children:[d.jsx(P,{mood:"negative",fitContent:!0,children:d.jsxs(w.Row,{gap:"var(--gap-2)",children:[d.jsx(k,{type:e[s]?.type??""}),d.jsxs(T.Bold,{children:[" ",e[s]?.title??"(none)"]})]})}),d.jsx("br",{}),d.jsx(D,{breakEqualHeight:!0,gap:{xs:"var(--gap-2)"},gridTemplateColumns:{xs:"1fr",sm:"1fr 1.7fr"},children:d.jsx("ul",{className:y.ul,children:d.jsx(z,{expanded:f,setSelectedId:r,selectedId:s,toggleExpand:o,node:i,depth:0})})})]})}export{Q as default,K as initialFileSystem};
